"0","vis_ht = function(tissue){"
"0","  res_jc = read_excel(paste0('../03.Results/HyperTest.',tissue,'.xlsx'), sheet = 3) %>%"
"0","    column_to_rownames(. , var = 'DEGs') %>% "
"0","    dplyr::select(-starts_with('Sucrose+JNK_D2')) %>% "
"0","    rownames_to_column(., var = 'Module') %>% "
"0","    gather(DEGs, JC, -Module) %>% "
"0","    mutate(mapID = paste0(Module, '#', DEGs))"
"0","  "
"0","  res_p = read_excel(paste0('../03.Results/HyperTest.',tissue,'.xlsx'), sheet = 1) %>%"
"0","    column_to_rownames(. , var = 'DEGs') %>% "
"0","    dplyr::select(-starts_with('Sucrose+JNK_D2')) %>% "
"0","    rownames_to_column(., var = 'Module') %>% "
"0","    gather(DEGs, pvalue, -Module) %>% "
"0","    mutate(mapID = paste0(Module, '#', DEGs)) %>% "
"0","    dplyr::select(-c(""DEGs"",""Module"")) %>% "
"0","    right_join(res_jc) %>% filter(pvalue < 0.05) %>% "
"0","    mutate(col = case_when(str_detect(DEGs, 'UP') ~ 'UP',"
"0","                           str_detect(DEGs, ""Down"") ~ 'Down')) %>% "
"0","    mutate(Module = fct_rev(Module)) %>% "
"0","    mutate(DEGs = factor(DEGs, levels = c(""Sucrose (UP)"",""Sucrose (Down)"","
"0","                                          ""Sucrose+JNK_D1 (UP)"","
"0","                                          ""Sucrose+JNK_D1 (Down)""))) %>% "
"0","    mutate(col = factor(col, levels = c(""UP"", ""Down""))) %>% "
"0","    ggplot(., aes(DEGs,Module)) + geom_point(aes(color = col,size = JC)) +"
"0","    theme_bw() +"
"0","    labs(size = 'Jaccard index', y = 'Gene Coxp. Module') +"
"0","    theme("
"0","          axis.title.y = element_text(color = 'black', size = 9),"
"0","          axis.title.x = element_blank(),"
"0","          axis.text.y = element_text(size = 8, color = 'black'),"
"0","          axis.text.x = element_text(angle = 45, hjust = 1, size = 8,"
"0","                                     vjust = 1, color = 'black'),"
"0","          panel.background = element_blank(),"
"0","          legend.title = element_text(color = 'black', size = 9),"
"0","      legend.text = element_text(color = 'black', size = 8),"
"0","      legend.key.height = unit(.4, 'cm'),"
"0","      legend.key.width = unit(.4, 'cm'))+"
"0","    scale_color_manual(values = c('#b20a2c','#1c92d2'))+"
"0","    guides(colour = 'none') "
"0","}"
"0","SkM = vis_ht('Muscle')"
"2","Joining with `by = join_by(mapID)`"
"0","Liver = vis_ht('Liver')"
"2","Joining with `by = join_by(mapID)`"
"0","vWAT = vis_ht('Adipose')"
"2","Joining with `by = join_by(mapID)`"
"0","Brain = vis_ht('Brain')"
"2","Joining with `by = join_by(mapID)`"
"0","comp = ggarrange(Liver, vWAT, SkM,Brain, nrow = 1, common.legend = T, legend = 'right')"
"0","ggsave(comp, file = '../02.Figures/coexpression.HT.dot.pdf',"
"0","       width = 8, height = 2.5)"
